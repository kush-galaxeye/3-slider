{"ast":null,"code":"import { useRef as e, useCallback as r, useEffect as n, useState as t } from \"react\";\nimport { jsx as o } from \"react/jsx-runtime\";\n\nfunction i(t) {\n  var o = t.redirectUri,\n      i = t.clientId,\n      c = t.onSuccess,\n      a = t.onError,\n      s = t.scope,\n      d = void 0 === s ? \"r_emailaddress\" : s,\n      u = t.state,\n      l = void 0 === u ? \"\" : u,\n      w = t.closePopupMessage,\n      p = void 0 === w ? \"User closed the popup\" : w,\n      g = e(null),\n      v = e(null),\n      f = r(function (e) {\n    var r = localStorage.getItem(\"linkedin_oauth2_state\");\n    if (e.origin === window.location.origin) if (e.data.errorMessage && \"Linked In\" === e.data.from) {\n      if (e.data.state !== r) return void (g.current && g.current.close());\n      a && a(e.data), g.current && g.current.close();\n    } else if (e.data.code && \"Linked In\" === e.data.from) {\n      if (e.data.state !== r) return void (g.current && g.current.close());\n      c && c(e.data.code), g.current && g.current.close();\n    }\n  }, [a, c]);\n  n(function () {\n    return function () {\n      window.removeEventListener(\"message\", f, !1), g.current && (g.current.close(), g.current = null), v.current && (window.clearInterval(v.current), v.current = null);\n    };\n  }, [f]), n(function () {\n    return window.addEventListener(\"message\", f, !1), function () {\n      window.removeEventListener(\"message\", f, !1);\n    };\n  }, [f]);\n\n  var h = function () {\n    var e = \"&scope=\" + encodeURI(d),\n        r = l || function (e) {\n      void 0 === e && (e = 20);\n\n      for (var r = \"\", n = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\", t = n.length, o = 0; o < e; o++) r += n.charAt(Math.floor(Math.random() * t));\n\n      return r;\n    }();\n\n    return localStorage.setItem(\"linkedin_oauth2_state\", r), \"https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=\" + i + \"&redirect_uri=\" + o + e + \"&state=\" + r;\n  };\n\n  return {\n    linkedInLogin: function () {\n      var e;\n      null === (e = g.current) || void 0 === e || e.close(), g.current = window.open(h(), \"_blank\", function (e) {\n        var r = e.width,\n            n = void 0 === r ? 600 : r,\n            t = e.height,\n            o = void 0 === t ? 600 : t;\n        return \"left=\" + (screen.width / 2 - n / 2) + \",top=\" + (screen.height / 2 - o / 2) + \",width=\" + n + \",height=\" + o;\n      }({\n        width: 600,\n        height: 600\n      })), v.current && (window.clearInterval(v.current), v.current = null), v.current = window.setInterval(function () {\n        try {\n          g.current && g.current.closed && (window.clearInterval(v.current), v.current = null, a && a({\n            error: \"user_closed_popup\",\n            errorMessage: p\n          }));\n        } catch (e) {\n          window.clearInterval(v.current), v.current = null;\n        }\n      }, 1e3);\n    }\n  };\n}\n\nfunction c(e) {\n  return (0, e.children)({\n    linkedInLogin: i({\n      redirectUri: e.redirectUri,\n      clientId: e.clientId,\n      onSuccess: e.onSuccess,\n      onError: e.onError,\n      state: e.state,\n      scope: e.scope,\n      closePopupMessage: e.closePopupMessage\n    }).linkedInLogin\n  });\n}\n\nfunction a() {\n  var e = t(\"\"),\n      r = e[0],\n      i = e[1];\n  return n(function () {\n    var e = function (e) {\n      for (var r = e.substring(1).split(\"&\"), n = {}, t = 0; t < r.length; t++) {\n        var o = r[t].split(\"=\");\n        o.length > 1 && (n[decodeURIComponent(o[0])] = decodeURIComponent(o[1]));\n      }\n\n      return n;\n    }(window.location.search);\n\n    if (e.state !== localStorage.getItem(\"linkedin_oauth2_state\")) i(\"State does not match\");else if (e.error) {\n      var r = e.error_description || \"Login failed. Please try again.\";\n      window.opener && window.opener.postMessage({\n        error: e.error,\n        state: e.state,\n        errorMessage: r,\n        from: \"Linked In\"\n      }, window.location.origin), \"user_cancelled_login\" === e.error && window.close();\n    }\n    e.code && window.opener && window.opener.postMessage({\n      code: e.code,\n      state: e.state,\n      from: \"Linked In\"\n    }, window.location.origin);\n  }, []), o(\"div\", {\n    children: r\n  }, void 0);\n}\n\nexport { c as LinkedIn, a as LinkedInCallback, i as useLinkedIn };","map":{"version":3,"sources":["../src/useLinkedIn.tsx","../src/utils.ts","../src/LinkedIn.tsx","../src/LinkedInCallback.tsx"],"names":["_a","_b","_c","screen","width","height","length","result","characters","charactersLength","i","charAt","Math","floor","random","useLinkedIn","redirectUri","clientId","onSuccess","onError","_d","popupRef","useRef","popUpIntervalRef","receiveMessage","useCallback","event","savedState","localStorage","getItem","origin","window","location","data","errorMessage","from","state","current","close","code","useEffect","removeEventListener","clearInterval","addEventListener","getUrl","scopeParam","encodeURI","scope","generatedState","generateRandomString","setItem","open","getPopupPositionProperties","setInterval","closed","error","closePopupMessage","linkedInLogin","search","substring","vars","split","parsed","pair","decodeURIComponent","LinkedIn","children","LinkedInCallback","setErrorMessage","useState","params","parse","errorMessage_1","error_description","opener","postMessage","_jsx"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\nimport { useLinkedInType } from './types';\nimport { LINKEDIN_OAUTH2_STATE } from './utils';\n\nconst getPopupPositionProperties = ({ width = 600, height = 600 }) => {\n  const left = screen.width / 2 - width / 2;\n  const top = screen.height / 2 - height / 2;\n  return `left=${left},top=${top},width=${width},height=${height}`;\n};\n\nconst generateRandomString = (length = 20) => {\n  let result = '';\n  const characters =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  const charactersLength = characters.length;\n  for (let i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n  return result;\n};\n\nexport function useLinkedIn({\n  redirectUri,\n  clientId,\n  onSuccess,\n  onError,\n  scope = 'r_emailaddress',\n  state = '',\n  closePopupMessage = 'User closed the popup',\n}: useLinkedInType) {\n  const popupRef = useRef<Window>(null);\n  const popUpIntervalRef = useRef<number>(null);\n\n  const receiveMessage = useCallback(\n    (event: MessageEvent) => {\n      const savedState = localStorage.getItem(LINKEDIN_OAUTH2_STATE);\n      if (event.origin === window.location.origin) {\n        if (event.data.errorMessage && event.data.from === 'Linked In') {\n          // Prevent CSRF attack by testing state\n          if (event.data.state !== savedState) {\n            popupRef.current && popupRef.current.close();\n            return;\n          }\n          onError && onError(event.data);\n          popupRef.current && popupRef.current.close();\n        } else if (event.data.code && event.data.from === 'Linked In') {\n          // Prevent CSRF attack by testing state\n          if (event.data.state !== savedState) {\n            console.error('State does not match');\n            popupRef.current && popupRef.current.close();\n            return;\n          }\n          onSuccess && onSuccess(event.data.code);\n          popupRef.current && popupRef.current.close();\n        }\n      }\n    },\n    [onError, onSuccess],\n  );\n\n  useEffect(() => {\n    return () => {\n      window.removeEventListener('message', receiveMessage, false);\n\n      if (popupRef.current) {\n        popupRef.current.close();\n        popupRef.current = null;\n      }\n      if (popUpIntervalRef.current) {\n        window.clearInterval(popUpIntervalRef.current);\n        popUpIntervalRef.current = null;\n      }\n    };\n  }, [receiveMessage]);\n\n  useEffect(() => {\n    window.addEventListener('message', receiveMessage, false);\n    return () => {\n      window.removeEventListener('message', receiveMessage, false);\n    };\n  }, [receiveMessage]);\n\n  const getUrl = () => {\n    const scopeParam = `&scope=${encodeURI(scope)}`;\n    const generatedState = state || generateRandomString();\n    localStorage.setItem(LINKEDIN_OAUTH2_STATE, generatedState);\n    const linkedInAuthLink = `https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=${clientId}&redirect_uri=${redirectUri}${scopeParam}&state=${generatedState}`;\n    return linkedInAuthLink;\n  };\n\n  const linkedInLogin = () => {\n    popupRef.current?.close();\n    popupRef.current = window.open(\n      getUrl(),\n      '_blank',\n      getPopupPositionProperties({ width: 600, height: 600 }),\n    );\n\n    if (popUpIntervalRef.current) {\n      window.clearInterval(popUpIntervalRef.current);\n      popUpIntervalRef.current = null;\n    }\n    popUpIntervalRef.current = window.setInterval(() => {\n      try {\n        if (popupRef.current && popupRef.current.closed) {\n          window.clearInterval(popUpIntervalRef.current);\n          popUpIntervalRef.current = null;\n          if (onError) {\n            onError({\n              error: 'user_closed_popup',\n              errorMessage: closePopupMessage,\n            });\n          }\n        }\n      } catch (error) {\n        console.error(error);\n        window.clearInterval(popUpIntervalRef.current);\n        popUpIntervalRef.current = null;\n      }\n    }, 1000);\n  };\n\n  return {\n    linkedInLogin,\n  };\n}\n","export const LINKEDIN_OAUTH2_STATE = 'linkedin_oauth2_state';\n\nexport function parse(search) {\n  const query = search.substring(1);\n  const vars = query.split('&');\n  const parsed = {};\n  for (let i = 0; i < vars.length; i++) {\n    const pair = vars[i].split('=');\n    if (pair.length > 1) {\n      parsed[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n  }\n  return parsed;\n}\n","import { LinkedInType } from './types';\nimport { useLinkedIn } from './useLinkedIn';\n\nexport function LinkedIn({\n  children,\n  redirectUri,\n  clientId,\n  onSuccess,\n  onError,\n  state,\n  scope,\n  closePopupMessage,\n}: LinkedInType) {\n  const { linkedInLogin } = useLinkedIn({\n    redirectUri,\n    clientId,\n    onSuccess,\n    onError,\n    state,\n    scope,\n    closePopupMessage,\n  });\n  return children({ linkedInLogin });\n}\n","import { useEffect, useState } from 'react';\nimport { LINKEDIN_OAUTH2_STATE, parse } from './utils';\n\ntype ParamsType = {\n  state: string;\n  code?: string;\n  error?: string;\n  error_description?: string;\n};\n\nexport function LinkedInCallback() {\n  const [errorMessage, setErrorMessage] = useState<string>('');\n  useEffect(() => {\n    const params = parse(window.location.search) as ParamsType;\n    if (params.state !== localStorage.getItem(LINKEDIN_OAUTH2_STATE)) {\n      setErrorMessage('State does not match');\n    } else if (params.error) {\n      const errorMessage =\n        params.error_description || 'Login failed. Please try again.';\n      window.opener &&\n        window.opener.postMessage(\n          {\n            error: params.error,\n            state: params.state,\n            errorMessage,\n            from: 'Linked In',\n          },\n          window.location.origin,\n        );\n      // Close tab if user cancelled login\n      if (params.error === 'user_cancelled_login') {\n        window.close();\n      }\n    }\n    if (params.code) {\n      window.opener &&\n        window.opener.postMessage(\n          { code: params.code, state: params.state, from: 'Linked In' },\n          window.location.origin,\n        );\n    }\n  }, []);\n\n  return <div>{errorMessage}</div>;\n}\n"]},"metadata":{},"sourceType":"module"}